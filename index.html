
<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Game Cocokkan Ayat - Dengan Efek Suara</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #f4f8ff 0%, #e6f0ff 100%);
      color: #333;
      line-height: 1.6;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 15px;
    }
    
    .orientation-warning {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.9);
      color: white;
      z-index: 1000;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      padding: 20px;
    }
    
    .orientation-warning p {
      font-size: 24px;
      margin-bottom: 20px;
    }
    
    .orientation-warning .rotate-icon {
      font-size: 64px;
      margin: 20px 0;
      animation: rotate 2s infinite;
    }
    
    @keyframes rotate {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(90deg); }
    }
    
    @media (orientation: portrait) {
      .orientation-warning {
        display: flex;
      }
    }
    
    .container {
      width: 100%;
      max-width: 900px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      overflow: hidden;
      margin-bottom: 20px;
    }
    
    header {
      background: linear-gradient(to right, #4a6fa5, #166088);
      color: white;
      padding: 15px;
      text-align: center;
    }
    
    h1 {
      font-size: 22px;
      margin-bottom: 8px;
    }
    
    .game-info {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      align-items: center;
      padding: 12px 15px;
      background-color: #f1f8ff;
      border-bottom: 1px solid #e2e8f0;
      gap: 10px;
    }
    
    .stats {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    
    .stat-box {
      background: white;
      padding: 6px 12px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
      font-weight: bold;
      display: flex;
      align-items: center;
      gap: 5px;
      font-size: 14px;
    }
    
    .controls {
      display: flex;
      gap: 8px;
    }
    
    button {
      padding: 8px 12px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.2s ease;
      font-size: 14px;
    }
    
    .btn-primary {
      background-color: #4a6fa5;
      color: white;
    }
    
    .btn-success {
      background-color: #28a745;
      color: white;
    }
    
    .btn-warning {
      background-color: #ffc107;
      color: #333;
    }
    
    .btn-danger {
      background-color: #dc3545;
      color: white;
    }
    
    .btn-whatsapp {
      background-color: #25D366;
      color: white;
    }
    
    button:active {
      transform: scale(0.98);
    }
    
    .game-container {
      position: relative;
      display: flex;
      justify-content: space-between;
      padding: 20px 15px;
      min-height: 300px;
    }
    
    .list {
      width: 45%;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    
    .list-title {
      text-align: center;
      margin-bottom: 12px;
      font-size: 16px;
      color: #166088;
      font-weight: 600;
      padding-bottom: 5px;
      border-bottom: 2px solid #4cb1a7;
    }
    
    .item {
      background: #fff;
      border: 2px solid #e2e8f0;
      border-radius: 10px;
      padding: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      z-index: 2;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    
    .item:active {
      transform: scale(0.98);
    }
    
    .arabic {
      font-size: 18px;
      font-weight: bold;
      text-align: right;
      margin-bottom: 6px;
      color: #166088;
      font-family: 'Traditional Arabic', 'Scheherazade New', serif;
    }
    
    .translation {
      font-size: 14px;
      color: #333;
      line-height: 1.4;
    }
    
    .selected {
      background: #fff9e6;
      border-color: #ffc107;
    }
    
    .correct {
      background: #eaffea;
      border-color: #28a745;
    }
    
    .wrong {
      background: #ffebeb;
      border-color: #dc3545;
    }
    
    svg {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
      pointer-events: none;
    }
    
    line {
      stroke: #a0aec0;
      stroke-width: 3;
      marker-end: url(#arrowhead);
      transition: all 0.3s ease;
    }
    
    .result-container {
      text-align: center;
      padding: 15px;
      background: #f8f9fa;
      border-top: 1px solid #e2e8f0;
    }
    
    #result {
      font-size: 16px;
      font-weight: bold;
      margin-bottom: 12px;
    }
    
    .progress-container {
      width: 100%;
      height: 8px;
      background: #e2e8f0;
      border-radius: 4px;
      overflow: hidden;
      margin: 12px 0;
    }
    
    .progress-bar {
      height: 100%;
      background: linear-gradient(to right, #4a6fa5, #4cb1a7);
      width: 0%;
      transition: width 0.5s ease;
    }
    
    .login-container {
      background: white;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      width: 100%;
      max-width: 400px;
      margin: 20px auto;
    }
    
    .input-group {
      margin: 15px 0;
      text-align: left;
    }
    
    .input-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
      color: #166088;
    }
    
    .input-group input {
      width: 100%;
      padding: 12px;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      font-size: 16px;
    }
    
    .input-group input:focus {
      outline: none;
      border-color: #4a6fa5;
    }
    
    .result-details {
      text-align: left;
      margin: 15px 0;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 10px;
    }
    
    .result-item {
      display: flex;
      justify-content: space-between;
      margin: 10px 0;
      padding-bottom: 8px;
      border-bottom: 1px solid #e2e8f0;
    }
    
    .result-item:last-child {
      border-bottom: none;
    }
    
    .result-value {
      font-weight: bold;
      color: #166088;
    }
    
    .whatsapp-icon {
      display: inline-block;
      vertical-align: middle;
      margin-right: 8px;
    }
    
    .hidden {
      display: none;
    }

    .surat-info {
      text-align: center;
      margin: 10px 0;
      font-weight: bold;
      color: #166088;
    }

    .sound-control {
      position: absolute;
      top: 10px;
      right: 10px;
      background: rgba(255, 255, 255, 0.8);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 10;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>
  <!--
  <div class="orientation-warning">
    <p>Putar perangkat Anda ke mode landscape</p>
    <div class="rotate-icon">üîÑ</div>
    <p>Untuk pengalaman bermain yang lebih baik</p>
  </div>
-->
  <div class="sound-control" id="soundControl" onclick="toggleSound()">üîä</div>

  <!-- Login Screen -->
  <div class="login-container" id="loginScreen">
    <h1>Game Mencocokkan Ayat</h1>
    <div class="input-group">
      <label for="playerName">Nama:</label>
      <input type="text" id="playerName" placeholder="Masukkan nama Anda">
    </div>
    <div class="input-group">
      <label for="playerClass">Kelas:</label>
      <input type="text" id="playerClass" placeholder="Masukkan kelas Anda">
    </div>
    <button class="btn-primary" onclick="startGame()" style="width: 100%; padding: 12px;">Mulai Game</button>
  </div>

  <!-- Game Screen -->
  <div class="container hidden" id="gameScreen">
    <header>
      <h1>Game Mencocokkan Ayat</h1>
      <p>Pilih ayat Arab dan artinya yang sesuai</p>
    </header>
    
    <div class="game-info">
      <div class="stats">
        <div class="stat-box">
          <span>‚è±Ô∏è</span>
          <span id="timer">0:00</span>
        </div>
        <div class="stat-box">
          <span>‚úÖ</span>
          <span id="score">0</span>
        </div>
        <div class="stat-box">
          <span>üìä</span>
          <span id="progress">0/0</span>
        </div>
        <div class="stat-box">
          <span>üìñ</span>
          <span id="surat-name">Al-Ikhlas</span>
        </div>
      </div>
      
      <div class="controls">
        <button class="btn-success" onclick="checkAnswers()">Cek</button>
        <button class="btn-warning" onclick="resetGame()">Reset</button>
      </div>
    </div>
    
    <div class="progress-container">
      <div class="progress-bar" id="progress-bar"></div>
    </div>

    <div class="surat-info">
      Surat: <span id="current-surat">Al-Ikhlas</span> - Ayat: <span id="current-ayat">1/4</span>
    </div>
    
    <div class="game-container" id="gameContainer">
      <svg id="connector">
        <defs>
          <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
            <polygon points="0 0, 10 3.5, 0 7" fill="#a0aec0" />
          </marker>
        </defs>
      </svg>
      
      <div class="list">
        <div class="list-title">Ayat Arab</div>
        <div id="arabicList"></div>
      </div>
      
      <div class="list">
        <div class="list-title">Terjemahan</div>
        <div id="translationList"></div>
      </div>
    </div>
    
    <div class="result-container">
      <p id="result"></p>
    </div>
  </div>

  <!-- Result Screen -->
  <div class="container hidden" id="resultScreen">
    <header>
      <h1>Alhamdulillah</h1>
      <p>Selamat! Anda telah menyelesaikan game</p>
    </header>
    
    <div class="result-details">
      <div class="result-item">
        <span>Nama:</span>
        <span class="result-value" id="resultName">-</span>
      </div>
      <div class="result-item">
        <span>Kelas:</span>
        <span class="result-value" id="resultClass">-</span>
      </div>
      <div class="result-item">
        <span>Nilai:</span>
        <span class="result-value" id="resultScore">0</span>
      </div>
      <div class="result-item">
        <span>Jumlah Benar:</span>
        <span class="result-value" id="resultCorrect">0</span>
      </div>
      <div class="result-item">
        <span>Jumlah Salah:</span>
        <span class="result-value" id="resultWrong">0</span>
      </div>
      <div class="result-item">
        <span>Waktu:</span>
        <span class="result-value" id="resultTime">0:00</span>
      </div>
      <div class="result-item">
        <span>Surat Terselesaikan:</span>
        <span class="result-value" id="resultSurat">0/10</span>
      </div>
    </div>
    
    <div class="result-container">
      <button class="btn-whatsapp" onclick="sendToWhatsApp()">
        <span class="whatsapp-icon">üì±</span> Kirim ke WhatsApp
      </button>
      <button class="btn-primary" onclick="restartGame()">Main Lagi</button>
    </div>
  </div>

  <!-- Audio Elements -->
  <audio id="clickSound" preload="auto">
    <source src="click.wav" type="audio/mpeg">
  </audio>
  <audio id="correctSound" preload="auto">
    <source src="correct.wav" type="audio/mpeg">
  </audio>
  <audio id="wrongSound" preload="auto">
    <source src="wrong_5.mp3" type="audio/mpeg">
  </audio>
  <audio id="completeSound" preload="auto">
    <source src="yay.mp3" type="audio/mpeg">
  </audio>
  <audio id="finishSound" preload="auto">
    <source src="success.mp3" type="audio/mpeg">
  </audio>

  <script>
    const dataSurat = {
      "Al-Ikhlas": [
        { arabic: "ŸÇŸèŸÑŸí ŸáŸèŸàŸé ÿßŸÑŸÑŸëŸ∞ŸáŸè ÿßŸéÿ≠ŸéÿØŸå€ö", arti: "Katakanlah: Dialah Allah, Yang Maha Esa" },
        { arabic: "ÿßŸéŸÑŸÑŸëŸ∞ŸáŸè ÿßŸÑÿµŸëŸéŸÖŸéÿØŸè€ö", arti: "Allah tempat meminta segala sesuatu" },
        { arabic: "ŸÑŸéŸÖŸí ŸäŸéŸÑŸêÿØŸí ŸàŸéŸÑŸéŸÖŸí ŸäŸèŸàŸíŸÑŸéÿØŸí€ô", arti: "Dia tiada beranak dan tiada pula diperanakkan" },
        { arabic: "ŸàŸéŸÑŸéŸÖŸí ŸäŸéŸÉŸèŸÜŸí ŸÑŸëŸéŸáŸó ŸÉŸèŸÅŸèŸàŸãÿß ÿßŸéÿ≠ŸéÿØŸå", arti: "Dan tidak ada seorang pun yang setara dengan Dia" }
      ],
      "Quraisy": [
        { arabic: "ŸÑŸêÿ•ŸêŸäŸÑŸéÿßŸÅŸê ŸÇŸèÿ±ŸéŸäŸíÿ¥Ÿç", arti: "Karena kebiasaan orang-orang Quraisy," },
        { arabic: "ÿ•ŸêŸäŸÑŸéÿßŸÅŸêŸáŸêŸÖŸí ÿ±Ÿêÿ≠ŸíŸÑŸéÿ©Ÿé ÿßŸÑÿ¥ŸêŸëÿ™Ÿéÿßÿ°Ÿê ŸàŸéÿßŸÑÿµŸéŸëŸäŸíŸÅŸê", arti: "(yaitu) kebiasaan mereka bepergian pada musim dingin dan musim panas." },
        { arabic: "ŸÅŸéŸÑŸíŸäŸéÿπŸíÿ®ŸèÿØŸèŸàÿß ÿ±Ÿéÿ®ŸéŸë ŸáŸéÿ∞Ÿéÿß ÿßŸÑŸíÿ®ŸéŸäŸíÿ™Ÿê", arti: "Maka hendaklah mereka menyembah Tuhan (pemilik) rumah ini (Ka'bah)," },
        { arabic: "ÿßŸÑŸéŸëÿ∞ŸêŸä ÿ£Ÿéÿ∑ŸíÿπŸéŸÖŸéŸáŸèŸÖŸí ŸÖŸêŸÜŸí ÿ¨ŸèŸàÿπŸç ŸàŸéÿ¢ŸÖŸéŸÜŸéŸáŸèŸÖŸí ŸÖŸêŸÜŸí ÿÆŸéŸàŸíŸÅŸç", arti: "Yang telah memberi makanan kepada mereka untuk menghilangkan lapar dan mengamankan mereka dari rasa ketakutan." }
      ]
    };
/*
      "Al-Fatihah": [
        { arabic: "ÿ®Ÿêÿ≥ŸíŸÖŸê ÿßŸÑŸÑŸëŸ∞ŸáŸê ÿßŸÑÿ±ŸëŸéÿ≠ŸíŸÖŸ∞ŸÜŸê ÿßŸÑÿ±ŸëŸéÿ≠ŸêŸäŸíŸÖŸê", arti: "Dengan menyebut nama Allah Yang Maha Pengasih lagi Maha Penyayang" },
        { arabic: "ÿßŸéŸÑŸíÿ≠ŸéŸÖŸíÿØŸè ŸÑŸêŸÑŸëŸ∞ŸáŸê ÿ±Ÿéÿ®ŸëŸê ÿßŸÑŸíÿπŸ∞ŸÑŸéŸÖŸêŸäŸíŸÜŸé€ô", arti: "Segala puji bagi Allah, Tuhan semesta alam" },
        { arabic: "ÿßŸÑÿ±ŸëŸéÿ≠ŸíŸÖŸ∞ŸÜŸê ÿßŸÑÿ±ŸëŸéÿ≠ŸêŸäŸíŸÖŸê€ô", arti: "Yang Maha Pengasih, Maha Penyayang" },
        { arabic: "ŸÖŸ∞ŸÑŸêŸÉŸê ŸäŸéŸàŸíŸÖŸê ÿßŸÑÿØŸëŸêŸäŸíŸÜŸê€ó", arti: "Yang menguasai di Hari Pembalasan" },
        { arabic: "ÿßŸêŸäŸéŸëÿßŸÉŸé ŸÜŸéÿπŸíÿ®ŸèÿØŸè ŸàŸéÿßŸêŸäŸéŸëÿßŸÉŸé ŸÜŸéÿ≥Ÿíÿ™ŸéÿπŸêŸäŸíŸÜŸè", arti: "Hanya kepada Engkaulah kami menyembah dan hanya kepada Engkaulah kami mohon pertolongan" },
        { arabic: "ÿßŸêŸáŸíÿØŸêŸÜŸéÿß ÿßŸÑÿµŸêŸëÿ±Ÿéÿßÿ∑Ÿé ÿßŸÑŸíŸÖŸèÿ≥Ÿíÿ™ŸéŸÇŸêŸäŸíŸÖŸé", arti: "Tunjukanlah kami jalan yang lurus" },
        { arabic: "ÿµŸêÿ±Ÿéÿßÿ∑Ÿé ÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ÿßŸéŸÜŸíÿπŸéŸÖŸíÿ™Ÿé ÿπŸéŸÑŸéŸäŸíŸáŸêŸÖŸí ÿ∫ŸéŸäŸíÿ±Ÿê ÿßŸÑŸíŸÖŸéÿ∫Ÿíÿ∂ŸèŸàŸíÿ®Ÿê ÿπŸéŸÑŸéŸäŸíŸáŸêŸÖŸí ŸàŸéŸÑŸéÿß ÿßŸÑÿ∂ŸéŸëÿßŸìŸÑŸêŸëŸäŸíŸÜŸé", arti: "(Yaitu) jalan orang-orang yang telah Engkau beri nikmat kepadanya; bukan (jalan) mereka yang dimurkai, dan bukan (pula jalan) mereka yang sesat." }
      ],
      "An-Nas": [
        { arabic: "ŸÇŸèŸÑŸí ÿ£ŸéÿπŸèŸàÿ∞Ÿè ÿ®Ÿêÿ±Ÿéÿ®ŸêŸë ÿßŸÑŸÜŸéŸëÿßÿ≥Ÿê", arti: "Katakanlah, Aku berlindung kepada Tuhannya manusia," },
        { arabic: "ŸÖŸéŸÑŸêŸÉŸê ÿßŸÑŸÜŸéŸëÿßÿ≥Ÿê", arti: "Raja manusia," },
        { arabic: "ÿ•ŸêŸÑŸéŸáŸê ÿßŸÑŸÜŸéŸëÿßÿ≥Ÿê", arti: "sembahan manusia," },
        { arabic: "ŸÖŸêŸÜŸí ÿ¥Ÿéÿ±ŸêŸë ÿßŸÑŸíŸàŸéÿ≥ŸíŸàŸéÿßÿ≥Ÿê ÿßŸÑŸíÿÆŸéŸÜŸéŸëÿßÿ≥Ÿê", arti: "dari kejahatan (bisikan) setan yang bersembunyi," },
        { arabic: "ÿßŸÑŸéŸëÿ∞ŸêŸä ŸäŸèŸàŸéÿ≥ŸíŸàŸêÿ≥Ÿè ŸÅŸêŸä ÿµŸèÿØŸèŸàÿ±Ÿê ÿßŸÑŸÜŸéŸëÿßÿ≥Ÿê", arti: "yang membisikkan (kejahatan) ke dalam dada manusia," },
        { arabic: "ŸÖŸêŸÜŸé ÿßŸÑŸíÿ¨ŸêŸÜŸéŸëÿ©Ÿê ŸàŸéÿßŸÑŸÜŸéŸëÿßÿ≥Ÿê", arti: "dari (golongan) jin dan manusia." }
      ],
      "Al-Falaq": [
        { arabic: "ŸÇŸèŸÑŸí ÿ£ŸéÿπŸèŸàÿ∞Ÿè ÿ®Ÿêÿ±Ÿéÿ®ŸêŸë ÿßŸÑŸíŸÅŸéŸÑŸéŸÇŸê", arti: "Katakanlah, Aku berlindung kepada Tuhan yang menguasai subuh (fajar)," },
        { arabic: "ŸÖŸêŸÜŸí ÿ¥Ÿéÿ±ŸêŸë ŸÖŸéÿß ÿÆŸéŸÑŸéŸÇŸé", arti: "dari kejahatan (makhluk yang) Dia ciptakan," },
        { arabic: "ŸàŸéŸÖŸêŸÜŸí ÿ¥Ÿéÿ±ŸêŸë ÿ∫Ÿéÿßÿ≥ŸêŸÇŸç ÿ•Ÿêÿ∞Ÿéÿß ŸàŸéŸÇŸéÿ®Ÿé", arti: "dan dari kejahatan malam apabila telah gelap gulita," },
        { arabic: "ŸàŸéŸÖŸêŸÜŸí ÿ¥Ÿéÿ±ŸêŸë ÿßŸÑŸÜŸéŸëŸÅŸéŸëÿßÿ´Ÿéÿßÿ™Ÿê ŸÅŸêŸä ÿßŸÑŸíÿπŸèŸÇŸéÿØŸê", arti: "dan dari kejahatan (perempuan-perempuan) penyihir yang meniup pada buhul-buhul (talinya)," },
        { arabic: "ŸàŸéŸÖŸêŸÜŸí ÿ¥Ÿéÿ±ŸêŸë ÿ≠Ÿéÿßÿ≥ÿØŸç ÿ•Ÿêÿ∞Ÿéÿß ÿ≠Ÿéÿ≥ŸéÿØŸé", arti: "dan dari kejahatan orang yang dengki apabila dia dengki." }
      ],
      "Al-Lahab": [
        { arabic: "ÿ™Ÿéÿ®ŸéŸëÿ™Ÿí ŸäŸéÿØŸéÿß ÿ£Ÿéÿ®ŸêŸä ŸÑŸéŸáŸéÿ®Ÿç ŸàŸéÿ™Ÿéÿ®ŸéŸë", arti: "Binasalah kedua tangan Abu Lahab dan benar-benar binasa dia!" },
        { arabic: "ŸÖŸéÿß ÿ£Ÿéÿ∫ŸíŸÜŸéŸâ ÿπŸéŸÜŸíŸáŸè ŸÖŸéÿßŸÑŸèŸáŸè ŸàŸéŸÖŸéÿß ŸÉŸéÿ≥Ÿéÿ®Ÿé", arti: "Tidaklah berguna baginya hartanya dan apa yang dia usahakan." },
        { arabic: "ÿ≥ŸéŸäŸéÿµŸíŸÑŸéŸâ ŸÜŸéÿßÿ±Ÿãÿß ÿ∞Ÿéÿßÿ™Ÿé ŸÑŸéŸáŸéÿ®Ÿç", arti: "Kelak dia akan masuk ke dalam api yang bergejolak (neraka)." },
        { arabic: "ŸàŸéÿßŸÖŸíÿ±Ÿéÿ£Ÿéÿ™ŸèŸáŸè ÿ≠ŸéŸÖŸéŸëÿßŸÑŸéÿ©Ÿé ÿßŸÑŸíÿ≠Ÿéÿ∑Ÿéÿ®Ÿê", arti: "Dan (begitu pula) istrinya, pembawa kayu bakar (penyebar fitnah)." },
        { arabic: "ŸÅŸêŸä ÿ¨ŸêŸäÿØŸêŸáŸéÿß ÿ≠Ÿéÿ®ŸíŸÑŸå ŸÖŸêŸÜŸí ŸÖŸéÿ≥ŸéÿØŸç", arti: "Di lehernya ada tali dari sabut yang dipintal." }
      ],
      "An-Nashr": [
        { arabic: "ÿ•Ÿêÿ∞Ÿéÿß ÿ¨Ÿéÿßÿ°Ÿé ŸÜŸéÿµŸíÿ±Ÿè ÿßŸÑŸÑŸéŸëŸáŸê ŸàŸéÿßŸÑŸíŸÅŸéÿ™Ÿíÿ≠Ÿè", arti: "Apabila telah datang pertolongan Allah dan kemenangan" },
        { arabic: "ŸàŸéÿ±Ÿéÿ£ŸéŸäŸíÿ™Ÿé ÿßŸÑŸÜŸéŸëÿßÿ≥Ÿé ŸäŸéÿØŸíÿÆŸèŸÑŸèŸàŸÜŸé ŸÅŸêŸä ÿØŸêŸäŸÜŸê ÿßŸÑŸÑŸéŸëŸáŸê ÿ£ŸéŸÅŸíŸàŸéÿßÿ¨Ÿãÿß", arti: "dan engkau melihat manusia berbondong-bondong masuk agama Allah," },
        { arabic: "ŸÅŸéÿ≥Ÿéÿ®ŸêŸëÿ≠Ÿí ÿ®Ÿêÿ≠ŸéŸÖŸíÿØŸê ÿ±Ÿéÿ®ŸêŸëŸÉŸé ŸàŸéÿßÿ≥Ÿíÿ™Ÿéÿ∫ŸíŸÅŸêÿ±ŸíŸáŸè €ö ÿ•ŸêŸÜŸéŸëŸáŸè ŸÉŸéÿßŸÜŸé ÿ™ŸéŸàŸéŸëÿßÿ®Ÿãÿß", arti: "bertasbihlah dengan memuji Tuhanmu dan mohonlah ampun kepada-Nya. Sesungguhnya Dia Maha Penerima tobat." }
      ],
      "Al-Kafirun": [
        { arabic: "ŸÇŸèŸÑŸí ŸäŸéÿß ÿ£ŸéŸäŸèŸëŸáŸéÿß ÿßŸÑŸíŸÉŸéÿßŸÅŸêÿ±ŸèŸàŸÜŸé", arti: "Katakanlah (Muhammad), Wahai orang-orang kafir!" },
        { arabic: "ŸÑŸéÿß ÿ£ŸéÿπŸíÿ®ŸèÿØŸè ŸÖŸéÿß ÿ™ŸéÿπŸíÿ®ŸèÿØŸèŸàŸÜŸé", arti: "Aku tidak akan menyembah apa yang kamu sembah." },
        { arabic: "ŸàŸéŸÑŸéÿß ÿ£ŸéŸÜŸíÿ™ŸèŸÖŸí ÿπŸéÿßÿ®ŸêÿØŸèŸàŸÜŸé ŸÖŸéÿß ÿ£ŸéÿπŸíÿ®ŸèÿØŸè", arti: "Dan kamu bukan penyembah apa yang aku sembah." },
        { arabic: "ŸàŸéŸÑŸéÿß ÿ£ŸéŸÜŸéÿß ÿπŸéÿßÿ®ŸêÿØŸå ŸÖŸéÿß ÿπŸéÿ®ŸéÿØŸíÿ™ŸèŸÖŸí", arti: "Dan aku tidak pernah menjadi penyembah apa yang kamu sembah." },
        { arabic: "ŸàŸéŸÑŸéÿß ÿ£ŸéŸÜŸíÿ™ŸèŸÖŸí ÿπŸéÿßÿ®ŸêÿØŸèŸàŸÜŸé ŸÖŸéÿß ÿ£ŸéÿπŸíÿ®ŸèÿØŸè", arti: "Dan kamu tidak pernah (pula) menjadi penyembah apa yang aku sembah." },
        { arabic: "ŸÑŸéŸÉŸèŸÖŸí ÿØŸêŸäŸÜŸèŸÉŸèŸÖŸí ŸàŸéŸÑŸêŸäŸé ÿØŸêŸäŸÜŸê", arti: "Untukmu agamamu, dan untukku agamaku." }
      ],
      "Al-Kautsar": [
        { arabic: "ÿ•ŸêŸÜŸéŸëÿß ÿ£ŸéÿπŸíÿ∑ŸéŸäŸíŸÜŸéÿßŸÉŸé ÿßŸÑŸíŸÉŸéŸàŸíÿ´Ÿéÿ±Ÿé", arti: "Sesungguhnya Kami telah memberikan kepadamu nikmat yang banyak." },
        { arabic: "ŸÅŸéÿµŸéŸÑŸêŸë ŸÑŸêÿ±Ÿéÿ®ŸêŸëŸÉŸé ŸàŸéÿßŸÜŸíÿ≠Ÿéÿ±Ÿí", arti: "Maka dirikanlah sholat karena Tuhanmu; dan berkorbanlah." },
        { arabic: "ÿ•ŸêŸÜŸéŸë ÿ¥ŸéÿßŸÜŸêÿ¶ŸéŸÉŸé ŸáŸèŸàŸé ÿßŸÑŸíÿ£Ÿéÿ®Ÿíÿ™Ÿéÿ±Ÿè", arti: "Sesungguhnya orang-orang yang membenci kamu dialah yang terputus." }
      ],
      "Al-Ma'un": [
        { arabic: "ÿ£Ÿéÿ±Ÿéÿ£ŸéŸäŸíÿ™Ÿé ÿßŸÑŸéŸëÿ∞ŸêŸä ŸäŸèŸÉŸéÿ∞ŸêŸëÿ®Ÿè ÿ®ŸêÿßŸÑÿØŸêŸëŸäŸÜŸê", arti: "Tahukah kamu orang yang mendustakan agama?" },
        { arabic: "ŸÅŸéÿ∞ŸéŸÑŸêŸÉŸé ÿßŸÑŸéŸëÿ∞ŸêŸä ŸäŸéÿØŸèÿπŸèŸë ÿßŸÑŸíŸäŸéÿ™ŸêŸäŸÖŸé", arti: "Maka orang itulah yang menghardik anak yatim," },
        { arabic: "ŸàŸéŸÑŸéÿß ŸäŸéÿ≠Ÿèÿ∂ŸèŸë ÿπŸéŸÑŸéŸâ ÿ∑ŸéÿπŸéÿßŸÖŸê ÿßŸÑŸíŸÖŸêÿ≥ŸíŸÉŸêŸäŸÜŸê", arti: "dan tidak menganjurkan memberi makan orang miskin." },
        { arabic: "ŸÅŸéŸàŸéŸäŸíŸÑŸå ŸÑŸêŸÑŸíŸÖŸèÿµŸéŸÑŸêŸëŸäŸÜŸé", arti: "Maka celakalah orang-orang yang shalat," },
        { arabic: "ÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ŸáŸèŸÖŸí ÿπŸéŸÜŸí ÿµŸéŸÑŸéÿßÿ™ŸêŸáŸêŸÖŸí ÿ≥ŸéÿßŸáŸèŸàŸÜŸé", arti: "(yaitu) orang-orang yang lalai terhadap shalatnya," },
        { arabic: "ÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ŸáŸèŸÖŸí ŸäŸèÿ±Ÿéÿßÿ°ŸèŸàŸÜŸé", arti: "yang berbuat ria," },
        { arabic: "ŸàŸéŸäŸéŸÖŸíŸÜŸéÿπŸèŸàŸÜŸé ÿßŸÑŸíŸÖŸéÿßÿπŸèŸàŸÜŸé", arti: "dan enggan (memberi) barang berguna." }
      ],
*/
    const suratList = Object.keys(dataSurat);
    let currentSuratIndex = 0;
    let ayatData = [];
    let selectedArabic = null;
    let pairs = {};
    let startTime = 0;
    let timerInterval = null;
    let score = 0;
    let correctCount = 0;
    let wrongCount = 0;
    let totalCount = 0;
    let playerName = "";
    let playerClass = "";
    let completedSurat = 0;
    let checkCount = 0;
    let soundEnabled = true;

    // Audio elements
    const clickSound = document.getElementById("clickSound");
    const correctSound = document.getElementById("correctSound");
    const wrongSound = document.getElementById("wrongSound");
    const completeSound = document.getElementById("completeSound");
    const finishSound = document.getElementById("finishSound");

    function playSound(sound) {
      if (soundEnabled) {
        sound.currentTime = 0;
        sound.play().catch(e => console.log("Audio play failed:", e));
      }
    }

    function toggleSound() {
      soundEnabled = !soundEnabled;
      document.getElementById("soundControl").textContent = soundEnabled ? "üîä" : "üîá";
    }

    function startGame() {
      playerName = document.getElementById("playerName").value.trim();
      playerClass = document.getElementById("playerClass").value.trim();
      
      if (!playerName || !playerClass) {
        alert("Silakan isi nama dan kelas terlebih dahulu!");
        return;
      }
      
      document.getElementById("loginScreen").classList.add("hidden");
      document.getElementById("gameScreen").classList.remove("hidden");
      
      initGame();
    }

    function initGame() {
      clearInterval(timerInterval);
      startTime = Date.now();
      timerInterval = setInterval(updateTimer, 1000);
      
      ayatData = dataSurat[suratList[currentSuratIndex]];
      selectedArabic = null;
      pairs = {};
      checkCount = 0;
      
      totalCount = ayatData.length;
      
      const arabicList = document.getElementById("arabicList");
      const translationList = document.getElementById("translationList");
      const connector = document.getElementById("connector");
      document.getElementById("result").textContent = "";
      arabicList.innerHTML = "";
      translationList.innerHTML = "";
      connector.querySelectorAll("line").forEach(l => l.remove());
      
      document.getElementById("score").textContent = score;
      document.getElementById("progress").textContent = `0/${totalCount}`;
      document.getElementById("surat-name").textContent = suratList[currentSuratIndex];
      document.getElementById("current-surat").textContent = suratList[currentSuratIndex];
      document.getElementById("current-ayat").textContent = `1/${totalCount}`;
      updateProgressBar();

      // Create Arabic items
      ayatData.forEach((ayat, index) => {
        const div = document.createElement("div");
        div.className = "item";
        div.innerHTML = `
          <div class="arabic">${ayat.arabic}</div>
        `;
        div.dataset.index = index;
        div.onclick = () => {
          playSound(clickSound);
          selectArabic(div);
        };
        arabicList.appendChild(div);
      });

      // Create shuffled translation items
      shuffle([...ayatData]).forEach((ayat) => {
        const originalIndex = ayatData.findIndex(a => a.arti === ayat.arti);
        const div = document.createElement("div");
        div.className = "item";
        div.innerHTML = `
          <div class="translation">${ayat.arti}</div>
        `;
        div.dataset.index = originalIndex;
        div.onclick = () => {
          playSound(clickSound);
          selectTranslation(div);
        };
        translationList.appendChild(div);
      });
    }

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function updateTimer() {
      const elapsed = Math.floor((Date.now() - startTime) / 1000);
      const minutes = Math.floor(elapsed / 60);
      const seconds = elapsed % 60;
      document.getElementById("timer").textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
    }

    function selectArabic(div) {
      document.querySelectorAll("#arabicList .item").forEach(d => d.classList.remove("selected"));
      selectedArabic = div;
      div.classList.add("selected");
    }

    function selectTranslation(div) {
      if (!selectedArabic) return;
      
      const arabicIndex = selectedArabic.dataset.index;
      const translationIndex = div.dataset.index;
      
      pairs[arabicIndex] = translationIndex;
      drawLines();
      
      selectedArabic.classList.remove("selected");
      selectedArabic = null;
      
      // Update current ayat info
      document.getElementById("current-ayat").textContent = `${Object.keys(pairs).length}/${totalCount}`;
    }

    function drawLines() {
      const svg = document.getElementById("connector");
      const container = document.getElementById("gameContainer");
      svg.querySelectorAll("line").forEach(l => l.remove());

      for (let aIndex in pairs) {
        const tIndex = pairs[aIndex];
        const arabicEl = document.querySelector(`#arabicList .item[data-index='${aIndex}']`);
        const translationEl = document.querySelector(`#translationList .item[data-index='${tIndex}']`);

        if (arabicEl && translationEl) {
          const rect1 = arabicEl.getBoundingClientRect();
          const rect2 = translationEl.getBoundingClientRect();
          const contRect = container.getBoundingClientRect();

          const x1 = rect1.right - contRect.left;
          const y1 = rect1.top + rect1.height/2 - contRect.top;
          const x2 = rect2.left - contRect.left;
          const y2 = rect2.top + rect2.height/2 - contRect.top;

          const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
          line.setAttribute("x1", x1);
          line.setAttribute("y1", y1);
          line.setAttribute("x2", x2);
          line.setAttribute("y2", y2);
          line.setAttribute("data-arabic", aIndex);
          line.setAttribute("data-translation", tIndex);
          svg.appendChild(line);
        }
      }
    }

    function checkAnswers() {
      playSound(clickSound);
      checkCount++; // Tambah jumlah pengecekan
      
      let correct = 0;
      const svg = document.getElementById("connector");

      svg.querySelectorAll("line").forEach(line => {
        const aIndex = line.getAttribute("data-arabic");
        const tIndex = line.getAttribute("data-translation");
        const arabicEl = document.querySelector(`#arabicList .item[data-index='${aIndex}']`);
        const translationEl = document.querySelector(`#translationList .item[data-index='${tIndex}']`);

        if (aIndex === tIndex) {
          correct++;
          arabicEl.classList.add("correct");
          translationEl.classList.add("correct");
          line.setAttribute("stroke", "#28a745");
        } else {
          arabicEl.classList.add("wrong");
          translationEl.classList.add("wrong");
          line.setAttribute("stroke", "#dc3545");
        }
      });

      // Calculate score - hanya jika semua pasangan benar
      if (correct === totalCount) {
        playSound(correctSound);
        
        // Hitung nilai: 100 untuk sempurna, dikurangi 2 untuk setiap pengecekan tambahan
        const suratScore = Math.max(0, 100 - ((checkCount - 1) * 2));
        score += suratScore;
        
        correctCount += correct;
        completedSurat++;
        
        document.getElementById("score").textContent = score;
        document.getElementById("progress").textContent = `${correct}/${totalCount}`;
        updateProgressBar();

        // Check if all surat are completed
        if (currentSuratIndex < suratList.length - 1) {
          // Move to next surat
          document.getElementById("result").textContent = `‚úÖ Surat ${suratList[currentSuratIndex]} selesai! +${suratScore} poin`;
          setTimeout(() => {
            currentSuratIndex++;
            initGame();
          }, 2000);
        } else {
          // All surat completed
          clearInterval(timerInterval);
          playSound(completeSound);
          setTimeout(showResult, 1000);
        }
      } else {
        // Jika masih ada kesalahan
        playSound(wrongSound);
        document.getElementById("result").textContent = `Masih ada ${totalCount - correct} yang salah. Perbaiki dan coba lagi!`;
      }
    }

    function updateProgressBar() {
      const progress = (Object.keys(pairs).length / totalCount) * 100;
      document.getElementById("progress-bar").style.width = `${progress}%`;
    }

    function resetGame() {
      playSound(clickSound);
      initGame();
    }

    function showResult() {
      playSound(finishSound);
      document.getElementById("gameScreen").classList.add("hidden");
      document.getElementById("resultScreen").classList.remove("hidden");
      
      const elapsed = Math.floor((Date.now() - startTime) / 1000);
      const minutes = Math.floor(elapsed / 60);
      const seconds = elapsed % 60;
      const timeString = `${minutes}:${seconds.toString().padStart(2, '0')}`;
      
      document.getElementById("resultName").textContent = playerName;
      document.getElementById("resultClass").textContent = playerClass;
      document.getElementById("resultScore").textContent = score;
      document.getElementById("resultCorrect").textContent = correctCount;
      document.getElementById("resultWrong").textContent = checkCount - completedSurat; // Salah = total cek - jumlah surat
      document.getElementById("resultTime").textContent = timeString;
      document.getElementById("resultSurat").textContent = `${completedSurat}/${suratList.length}`;
    }

    function sendToWhatsApp() {
      playSound(clickSound);
      const phoneNumber = "+6281939352081";
      const elapsed = Math.floor((Date.now() - startTime) / 1000);
      const minutes = Math.floor(elapsed / 60);
      const seconds = elapsed % 60;
      const timeString = `${minutes}:${seconds.toString().padStart(2, '0')}`;
      const wrongAnswers = checkCount - completedSurat;
      
      let message = `*HASIL GAME COCOKKAN AYAT*%0A%0A`;
      message += `Nama: ${playerName}%0A`;
      message += `Kelas: ${playerClass}%0A`;
      message += `Nilai: ${score}%0A`;
      message += `Jumlah Benar: ${correctCount}%0A`;
      message += `Jumlah Salah: ${wrongAnswers}%0A`;
      message += `Waktu: ${timeString}%0A`;
      message += `Surat Terselesaikan: ${completedSurat}/${suratList.length}%0A%0A`;
      message += `*Selamat!* üéâ`;
      
      const whatsappURL = `https://wa.me/${phoneNumber}?text=${message}`;
      window.open(whatsappURL, '_blank');
    }

    function restartGame() {
      playSound(clickSound);
      currentSuratIndex = 0;
      score = 0;
      correctCount = 0;
      wrongCount = 0;
      completedSurat = 0;
      checkCount = 0;
      
      document.getElementById("resultScreen").classList.add("hidden");
      document.getElementById("gameScreen").classList.remove("hidden");
      initGame();
    }

    // Lock orientation to landscape on mobile devices
    function lockOrientation() {
      if (screen.orientation && screen.orientation.lock) {
        screen.orientation.lock('landscape').catch(function(error) {
          console.log('Orientation lock failed: ', error);
        });
      }
    }

    // Initialize the game on load
    window.onload = function() {
      // Focus on name input
      document.getElementById("playerName").focus();
      
      // Try to lock orientation on mobile
      if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
        lockOrientation();
      }
    };

    // kode spread sheet
    // Fungsi untuk menyimpan hasil ke Spreadsheet
async function saveToSpreadsheet(playerData) {
  try {
    google.script.run
      .withSuccessHandler(function(result) {
        console.log('Data saved successfully:', result);
      })
      .withFailureHandler(function(error) {
        console.error('Error saving data:', error);
        // Fallback: tampilkan pesan error
        alert('Gagal menyimpan ke spreadsheet: ' + error);
      })
      .saveGameResult(playerData);
  } catch (error) {
    console.error('Error:', error);
  }
}

// Fungsi untuk mengambil data surat dari Spreadsheet
async function loadSuratDataFromSheet() {
  try {
    google.script.run
      .withSuccessHandler(function(result) {
        if (result.success) {
          dataSurat = result.data;
          console.log('Surat data loaded:', Object.keys(dataSurat));
        } else {
          console.error('Error loading surat data:', result.message);
          // Gunakan data default jika gagal load
          useDefaultData();
        }
      })
      .withFailureHandler(function(error) {
        console.error('Error:', error);
        useDefaultData();
      })
      .getSuratData();
  } catch (error) {
    console.error('Error:', error);
    useDefaultData();
  }
}

function useDefaultData() {
  // Tetap gunakan data default yang sudah ada
  console.log('Using default surat data');
  // dataSurat sudah didefinisikan di kode asli
}

// Modifikasi fungsi showResult() untuk menyimpan data
function showResult() {
  playSound(finishSound);
  document.getElementById("gameScreen").classList.add("hidden");
  document.getElementById("resultScreen").classList.remove("hidden");
  
  const elapsed = Math.floor((Date.now() - startTime) / 1000);
  const minutes = Math.floor(elapsed / 60);
  const seconds = elapsed % 60;
  const timeString = `${minutes}:${seconds.toString().padStart(2, '0')}`;
  const wrongAnswers = checkCount - completedSurat;
  
  // Update UI
  document.getElementById("resultName").textContent = playerName;
  document.getElementById("resultClass").textContent = playerClass;
  document.getElementById("resultScore").textContent = score;
  document.getElementById("resultCorrect").textContent = correctCount;
  document.getElementById("resultWrong").textContent = wrongAnswers;
  document.getElementById("resultTime").textContent = timeString;
  document.getElementById("resultSurat").textContent = `${completedSurat}/${suratList.length}`;
  
  // Save to spreadsheet
  const playerData = {
    playerName: playerName,
    playerClass: playerClass,
    score: score,
    correctCount: correctCount,
    wrongCount: wrongAnswers,
    time: timeString,
    completedSurat: completedSurat,
    checkCount: checkCount
  };
  
  saveToSpreadsheet(playerData);
}

// Modifikasi window.onload untuk load data dari sheet
window.onload = function() {
  // Focus on name input
  document.getElementById("playerName").focus();
  
  // Load surat data from spreadsheet
  loadSuratDataFromSheet();
  
  // Try to lock orientation on mobile
  if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
    lockOrientation();
  }
};

    // =====================
// Alternative method tanpa fetch API
function saveToSpreadsheet(playerData) {
  // Jika menggunakan Google Apps Script sebagai web app
  if (typeof google !== 'undefined' && google.script) {
    // Method original untuk embedded web app
    google.script.run
      .withSuccessHandler(function(result) {
        console.log('Data saved successfully:', result);
      })
      .withFailureHandler(function(error) {
        console.error('Error saving data:', error);
      })
      .saveGameResult(playerData);
  } else {
    // Method untuk external website
    const webAppUrl = 'https://script.google.com/macros/s/AKfycbypH_q7_6FSGOfVptbHllX2CLdMqBNJDMEnp7i87NBtiVz8UPktOaJGAggc5KrlnQXL/exec';
    
    // Create form submission
    const form = document.createElement('form');
    form.method = 'POST';
    form.action = webAppUrl;
    form.style.display = 'none';
    
    // Add data as hidden inputs
    for (const key in playerData) {
      const input = document.createElement('input');
      input.type = 'hidden';
      input.name = key;
      input.value = playerData[key];
      form.appendChild(input);
    }
    
    document.body.appendChild(form);
    form.submit();
    
    console.log('Data submitted via form');
  }
}
 /*   
    // Konfigurasi Apps Script URL - GANTI DENGAN URL ANDA
const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbypH_q7_6FSGOfVptbHllX2CLdMqBNJDMEnp7i87NBtiVz8UPktOaJGAggc5KrlnQXL/exec';

// Fungsi untuk memanggil Google Apps Script
async function callAppsScript(functionName, data = {}) {
  try {
    const response = await fetch(APPS_SCRIPT_URL, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        function: functionName,
        data: data
      })
    });
    
    const result = await response.json();
    return result;
  } catch (error) {
    console.error('Error calling Apps Script:', error);
    return { success: false, message: error.toString() };
  }
}

// Fungsi untuk menyimpan hasil ke Spreadsheet (MODIFIED)
async function saveToSpreadsheet(playerData) {
  try {
    const result = await callAppsScript('saveGameResult', playerData);
    
    if (result.success) {
      console.log('Data saved successfully:', result);
    } else {
      console.error('Error saving data:', result.message);
      alert('Gagal menyimpan ke spreadsheet: ' + result.message);
    }
  } catch (error) {
    console.error('Error:', error);
  }
}

// Fungsi untuk mengambil data surat dari Spreadsheet (MODIFIED)
async function loadSuratDataFromSheet() {
  try {
    const result = await callAppsScript('getSuratData');
    
    if (result.success) {
      dataSurat = result.data;
      suratList = Object.keys(dataSurat);
      console.log('Surat data loaded:', suratList);
    } else {
      console.error('Error loading surat data:', result.message);
      useDefaultData();
    }
  } catch (error) {
    console.error('Error:', error);
    useDefaultData();
  }
} */
  </script>
</body>
</html>
